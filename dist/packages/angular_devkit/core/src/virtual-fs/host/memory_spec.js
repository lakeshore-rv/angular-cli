"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
// tslint:disable:no-implicit-dependencies
// tslint:disable:non-null-operator
const core_1 = require("@angular-devkit/core");
const buffer_1 = require("./buffer");
const memory_1 = require("./memory");
const sync_1 = require("./sync");
describe('SimpleMemoryHost', () => {
    it('can watch', () => {
        const host = new sync_1.SyncDelegateHost(new memory_1.SimpleMemoryHost());
        host.write(core_1.normalize('/sub/file1'), buffer_1.stringToFileBuffer(''));
        let recursiveCalled = 0;
        let noRecursiveCalled = 0;
        let noRecursiveFileCalled = 0;
        let diffFile = 0;
        host.watch(core_1.normalize('/sub'), { recursive: true }).subscribe(() => recursiveCalled++);
        host.watch(core_1.normalize('/sub')).subscribe(() => noRecursiveCalled++);
        host.watch(core_1.normalize('/sub/file2')).subscribe(() => noRecursiveFileCalled++);
        host.watch(core_1.normalize('/sub/file3')).subscribe(() => diffFile++);
        host.write(core_1.normalize('/sub/file2'), buffer_1.stringToFileBuffer(''));
        expect(recursiveCalled).toBe(1);
        expect(noRecursiveCalled).toBe(0);
        expect(noRecursiveFileCalled).toBe(1);
        expect(diffFile).toBe(0);
        host.write(core_1.normalize('/sub/file3'), buffer_1.stringToFileBuffer(''));
        expect(recursiveCalled).toBe(2);
        expect(noRecursiveCalled).toBe(0);
        expect(noRecursiveFileCalled).toBe(1);
        expect(diffFile).toBe(1);
    });
    it('can read', () => {
        const host = new sync_1.SyncDelegateHost(new memory_1.SimpleMemoryHost());
        const buffer = buffer_1.stringToFileBuffer('hello');
        host.write(core_1.normalize('/hello'), buffer);
        expect(host.read(core_1.normalize('/hello'))).toBe(buffer);
    });
    it('can delete', () => {
        const host = new sync_1.SyncDelegateHost(new memory_1.SimpleMemoryHost());
        const buffer = buffer_1.stringToFileBuffer('hello');
        expect(host.exists(core_1.normalize('/sub/file1'))).toBe(false);
        host.write(core_1.normalize('/sub/file1'), buffer);
        expect(host.exists(core_1.normalize('/sub/file1'))).toBe(true);
        host.delete(core_1.normalize('/sub/file1'));
        expect(host.exists(core_1.normalize('/sub/file1'))).toBe(false);
    });
    it('can rename', () => {
        const host = new sync_1.SyncDelegateHost(new memory_1.SimpleMemoryHost());
        const buffer = buffer_1.stringToFileBuffer('hello');
        expect(host.exists(core_1.normalize('/sub/file1'))).toBe(false);
        host.write(core_1.normalize('/sub/file1'), buffer);
        expect(host.exists(core_1.normalize('/sub/file1'))).toBe(true);
        host.rename(core_1.normalize('/sub/file1'), core_1.normalize('/sub/file2'));
        expect(host.exists(core_1.normalize('/sub/file1'))).toBe(false);
        expect(host.exists(core_1.normalize('/sub/file2'))).toBe(true);
        expect(host.read(core_1.normalize('/sub/file2'))).toBe(buffer);
    });
    it('can list', () => {
        const host = new sync_1.SyncDelegateHost(new memory_1.SimpleMemoryHost());
        const buffer = buffer_1.stringToFileBuffer('hello');
        host.write(core_1.normalize('/sub/file1'), buffer);
        host.write(core_1.normalize('/sub/file2'), buffer);
        host.write(core_1.normalize('/sub/sub1/file3'), buffer);
        host.write(core_1.normalize('/file4'), buffer);
        expect(host.list(core_1.normalize('/sub')))
            .toEqual([core_1.fragment('file1'), core_1.fragment('file2'), core_1.fragment('sub1')]);
        expect(host.list(core_1.normalize('/')))
            .toEqual([core_1.fragment('sub'), core_1.fragment('file4')]);
        expect(host.list(core_1.normalize('/inexistent'))).toEqual([]);
    });
    it('supports isFile / isDirectory', () => {
        const host = new sync_1.SyncDelegateHost(new memory_1.SimpleMemoryHost());
        const buffer = buffer_1.stringToFileBuffer('hello');
        host.write(core_1.normalize('/sub/file1'), buffer);
        host.write(core_1.normalize('/sub/file2'), buffer);
        host.write(core_1.normalize('/sub/sub1/file3'), buffer);
        host.write(core_1.normalize('/file4'), buffer);
        expect(host.isFile(core_1.normalize('/sub'))).toBe(false);
        expect(host.isFile(core_1.normalize('/sub1'))).toBe(false);
        expect(host.isDirectory(core_1.normalize('/'))).toBe(true);
        expect(host.isDirectory(core_1.normalize('/sub'))).toBe(true);
        expect(host.isDirectory(core_1.normalize('/sub/sub1'))).toBe(true);
        expect(host.isDirectory(core_1.normalize('/sub/file1'))).toBe(false);
        expect(host.isDirectory(core_1.normalize('/sub/sub1/file3'))).toBe(false);
    });
    it('makes every path absolute', () => {
        const host = new sync_1.SyncDelegateHost(new memory_1.SimpleMemoryHost());
        const buffer = buffer_1.stringToFileBuffer('hello');
        const buffer2 = buffer_1.stringToFileBuffer('hello 2');
        host.write(core_1.normalize('file1'), buffer);
        host.write(core_1.normalize('/sub/file2'), buffer);
        host.write(core_1.normalize('sub/file2'), buffer2);
        expect(host.isFile(core_1.normalize('file1'))).toBe(true);
        expect(host.isFile(core_1.normalize('/file1'))).toBe(true);
        expect(host.isFile(core_1.normalize('/sub/file2'))).toBe(true);
        expect(host.read(core_1.normalize('sub/file2'))).toBe(buffer2);
        expect(host.isDirectory(core_1.normalize('/sub'))).toBe(true);
        expect(host.isDirectory(core_1.normalize('sub'))).toBe(true);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVtb3J5X3NwZWMuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2VybmllZGF2aXMvQ29kZS9hbmd1bGFyLWNsaS8iLCJzb3VyY2VzIjpbInBhY2thZ2VzL2FuZ3VsYXJfZGV2a2l0L2NvcmUvc3JjL3ZpcnR1YWwtZnMvaG9zdC9tZW1vcnlfc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7R0FNRztBQUNILDBDQUEwQztBQUMxQyxtQ0FBbUM7QUFDbkMsK0NBQTJEO0FBQzNELHFDQUE4QztBQUM5QyxxQ0FBNEM7QUFDNUMsaUNBQTBDO0FBRTFDLFFBQVEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFFaEMsRUFBRSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7UUFDbkIsTUFBTSxJQUFJLEdBQUcsSUFBSSx1QkFBZ0IsQ0FBQyxJQUFJLHlCQUFnQixFQUFFLENBQUMsQ0FBQztRQUUxRCxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFTLENBQUMsWUFBWSxDQUFDLEVBQUUsMkJBQWtCLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUU1RCxJQUFJLGVBQWUsR0FBRyxDQUFDLENBQUM7UUFDeEIsSUFBSSxpQkFBaUIsR0FBRyxDQUFDLENBQUM7UUFDMUIsSUFBSSxxQkFBcUIsR0FBRyxDQUFDLENBQUM7UUFDOUIsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDO1FBRWpCLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQVMsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsQ0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDO1FBQ3hGLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7UUFDckUsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFB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Q0FBQztRQUN2RCxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDeEQsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vYW5ndWxhci5pby9saWNlbnNlXG4gKi9cbi8vIHRzbGludDpkaXNhYmxlOm5vLWltcGxpY2l0LWRlcGVuZGVuY2llc1xuLy8gdHNsaW50OmRpc2FibGU6bm9uLW51bGwtb3BlcmF0b3JcbmltcG9ydCB7IGZyYWdtZW50LCBub3JtYWxpemUgfSBmcm9tICdAYW5ndWxhci1kZXZraXQvY29yZSc7XG5pbXBvcnQgeyBzdHJpbmdUb0ZpbGVCdWZmZXIgfSBmcm9tICcuL2J1ZmZlcic7XG5pbXBvcnQgeyBTaW1wbGVNZW1vcnlIb3N0IH0gZnJvbSAnLi9tZW1vcnknO1xuaW1wb3J0IHsgU3luY0RlbGVnYXRlSG9zdCB9IGZyb20gJy4vc3luYyc7XG5cbmRlc2NyaWJlKCdTaW1wbGVNZW1vcnlIb3N0JywgKCkgPT4ge1xuXG4gIGl0KCdjYW4gd2F0Y2gnLCAoKSA9PiB7XG4gICAgY29uc3QgaG9zdCA9IG5ldyBTeW5jRGVsZWdhdGVIb3N0KG5ldyBTaW1wbGVNZW1vcnlIb3N0KCkpO1xuXG4gICAgaG9zdC53cml0ZShub3JtYWxpemUoJy9zdWIvZmlsZTEnKSwgc3RyaW5nVG9GaWxlQnVmZmVyKCcnKSk7XG5cbiAgICBsZXQgcmVjdXJzaXZlQ2FsbGVkID0gMDtcbiAgICBsZXQgbm9SZWN1cnNpdmVDYWxsZWQgPSAwO1xuICAgIGxldCBub1JlY3Vyc2l2ZUZpbGVDYWxsZWQgPSAwO1xuICAgIGxldCBkaWZmRmlsZSA9IDA7XG5cbiAgICBob3N0LndhdGNoKG5vcm1hbGl6ZSgnL3N1YicpLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KSAhLnN1YnNjcmliZSgoKSA9PiByZWN1cnNpdmVDYWxsZWQrKyk7XG4gICAgaG9zdC53YXRjaChub3JtYWxpemUoJy9zdWInKSkgIS5zdWJzY3JpYmUoKCkgPT4gbm9SZWN1cnNpdmVDYWxsZWQrKyk7XG4gICAgaG9zdC53YXRjaChub3JtYWxpemUoJy9zdWIvZmlsZTInKSkgIS5zdWJzY3JpYmUoKCkgPT4gbm9SZWN1cnNpdmVGaWxlQ2FsbGVkKyspO1xuICAgIGhvc3Qud2F0Y2gobm9ybWFsaXplKCcvc3ViL2ZpbGUzJykpICEuc3Vic2NyaWJlKCgpID0+IGRpZmZGaWxlKyspO1xuXG4gICAgaG9zdC53cml0ZShub3JtYWxpemUoJy9zdWIvZmlsZTInKSwgc3RyaW5nVG9GaWxlQnVmZmVyKCcnKSk7XG5cbiAgICBleHBlY3QocmVjdXJzaXZlQ2FsbGVkKS50b0JlKDEpO1xuICAgIGV4cGVjdChub1JlY3Vyc2l2ZUNhbGxlZCkudG9CZSgwKTtcbiAgICBleHBlY3Qobm9SZWN1cnNpdmVGaWxlQ2FsbGVkKS50b0JlKDEpO1xuICAgIGV4cGVjdChkaWZmRmlsZSkudG9CZSgwKTtcblxuICAgIGhvc3Qud3JpdGUobm9ybWFsaXplKCcvc3ViL2ZpbGUzJyksIHN0cmluZ1RvRmlsZUJ1ZmZlcignJykpO1xuXG4gICAgZXhwZWN0KHJlY3Vyc2l2ZUNhbGxlZCkudG9CZSgyKTtcbiAgICBleHBlY3Qobm9SZWN1cnNpdmVDYWxsZWQpLnRvQmUoMCk7XG4gICAgZXhwZWN0KG5vUmVjdXJzaXZlRmlsZUNhbGxlZCkudG9CZSgxKTtcbiAgICBleHBlY3QoZGlmZkZpbGUpLnRvQmUoMSk7XG4gIH0pO1xuXG4gIGl0KCdjYW4gcmVhZCcsICgpID0+IHtcbiAgICBjb25zdCBob3N0ID0gbmV3IFN5bmNEZWxlZ2F0ZUhvc3QobmV3IFNpbXBsZU1lbW9yeUhvc3QoKSk7XG5cbiAgICBjb25zdCBidWZmZXIgPSBzdHJpbmdUb0ZpbGVCdWZmZXIoJ2hlbGxvJyk7XG5cbiAgICBob3N0LndyaXRlKG5vcm1hbGl6ZSgnL2hlbGxvJyksIGJ1ZmZlcik7XG4gICAgZXhwZWN0KGhvc3QucmVhZChub3JtYWxpemUoJy9oZWxsbycpKSkudG9CZShidWZmZXIpO1xuICB9KTtcblxuICBpdCgnY2FuIGRlbGV0ZScsICgpID0+IHtcbiAgICBjb25zdCBob3N0ID0gbmV3IFN5bmNEZWxlZ2F0ZUhvc3QobmV3IFNpbXBsZU1lbW9yeUhvc3QoKSk7XG5cbiAgICBjb25zdCBidWZmZXIgPSBzdHJpbmdUb0ZpbGVCdWZmZXIoJ2hlbGxvJyk7XG5cbiAgICBleHBlY3QoaG9zdC5leGlzdHMobm9ybWFsaXplKCcvc3ViL2ZpbGUxJykpKS50b0JlKGZhbHNlKTtcbiAgICBob3N0LndyaXRlKG5vcm1hbGl6ZSgnL3N1Yi9maWxlMScpLCBidWZmZXIpO1xuICAgIGV4cGVjdChob3N0LmV4aXN0cyhub3JtYWxpemUoJy9zdWIvZmlsZTEnKSkpLnRvQmUodHJ1ZSk7XG4gICAgaG9zdC5kZWxldGUobm9ybWFsaXplKCcvc3ViL2ZpbGUxJykpO1xuICAgIGV4cGVjdChob3N0LmV4aXN0cyhub3JtYWxpemUoJy9zdWIvZmlsZTEnKSkpLnRvQmUoZmFsc2UpO1xuICB9KTtcblxuICBpdCgnY2FuIHJlbmFtZScsICgpID0+IHtcbiAgICBjb25zdCBob3N0ID0gbmV3IFN5bmNEZWxlZ2F0ZUhvc3QobmV3IFNpbXBsZU1lbW9yeUhvc3QoKSk7XG5cbiAgICBjb25zdCBidWZmZXIgPSBzdHJpbmdUb0ZpbGVCdWZmZXIoJ2hlbGxvJyk7XG5cbiAgICBleHBlY3QoaG9zdC5leGlzdHMobm9ybWFsaXplKCcvc3ViL2ZpbGUxJykpKS50b0JlKGZhbHNlKTtcbiAgICBob3N0LndyaXRlKG5vcm1hbGl6ZSgnL3N1Yi9maWxlMScpLCBidWZmZXIpO1xuICAgIGV4cGVjdChob3N0LmV4aXN0cyhub3JtYWxpemUoJy9zdWIvZmlsZTEnKSkpLnRvQmUodHJ1ZSk7XG4gICAgaG9zdC5yZW5hbWUobm9ybWFsaXplKCcvc3ViL2ZpbGUxJyksIG5vcm1hbGl6ZSgnL3N1Yi9maWxlMicpKTtcbiAgICBleHBlY3QoaG9zdC5leGlzdHMobm9ybWFsaXplKCcvc3ViL2ZpbGUxJykpKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3QoaG9zdC5leGlzdHMobm9ybWFsaXplKCcvc3ViL2ZpbGUyJykpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChob3N0LnJlYWQobm9ybWFsaXplKCcvc3ViL2ZpbGUyJykpKS50b0JlKGJ1ZmZlcik7XG4gIH0pO1xuXG4gIGl0KCdjYW4gbGlzdCcsICgpID0+IHtcbiAgICBjb25zdCBob3N0ID0gbmV3IFN5bmNEZWxlZ2F0ZUhvc3QobmV3IFNpbXBsZU1lbW9yeUhvc3QoKSk7XG5cbiAgICBjb25zdCBidWZmZXIgPSBzdHJpbmdUb0ZpbGVCdWZmZXIoJ2hlbGxvJyk7XG5cbiAgICBob3N0LndyaXRlKG5vcm1hbGl6ZSgnL3N1Yi9maWxlMScpLCBidWZmZXIpO1xuICAgIGhvc3Qud3JpdGUobm9ybWFsaXplKCcvc3ViL2ZpbGUyJyksIGJ1ZmZlcik7XG4gICAgaG9zdC53cml0ZShub3JtYWxpemUoJy9zdWIvc3ViMS9maWxlMycpLCBidWZmZXIpO1xuICAgIGhvc3Qud3JpdGUobm9ybWFsaXplKCcvZmlsZTQnKSwgYnVmZmVyKTtcblxuICAgIGV4cGVjdChob3N0Lmxpc3Qobm9ybWFsaXplKCcvc3ViJykpKVxuICAgICAgLnRvRXF1YWwoW2ZyYWdtZW50KCdmaWxlMScpLCBmcmFnbWVudCgnZmlsZTInKSwgZnJhZ21lbnQoJ3N1YjEnKV0pO1xuICAgIGV4cGVjdChob3N0Lmxpc3Qobm9ybWFsaXplKCcvJykpKVxuICAgICAgLnRvRXF1YWwoW2ZyYWdtZW50KCdzdWInKSwgZnJhZ21lbnQoJ2ZpbGU0JyldKTtcbiAgICBleHBlY3QoaG9zdC5saXN0KG5vcm1hbGl6ZSgnL2luZXhpc3RlbnQnKSkpLnRvRXF1YWwoW10pO1xuICB9KTtcblxuICBpdCgnc3VwcG9ydHMgaXNGaWxlIC8gaXNEaXJlY3RvcnknLCAoKSA9PiB7XG4gICAgY29uc3QgaG9zdCA9IG5ldyBTeW5jRGVsZWdhdGVIb3N0KG5ldyBTaW1wbGVNZW1vcnlIb3N0KCkpO1xuXG4gICAgY29uc3QgYnVmZmVyID0gc3RyaW5nVG9GaWxlQnVmZmVyKCdoZWxsbycpO1xuXG4gICAgaG9zdC53cml0ZShub3JtYWxpemUoJy9zdWIvZmlsZTEnKSwgYnVmZmVyKTtcbiAgICBob3N0LndyaXRlKG5vcm1hbGl6ZSgnL3N1Yi9maWxlMicpLCBidWZmZXIpO1xuICAgIGhvc3Qud3JpdGUobm9ybWFsaXplKCcvc3ViL3N1YjEvZmlsZTMnKSwgYnVmZmVyKTtcbiAgICBob3N0LndyaXRlKG5vcm1hbGl6ZSgnL2ZpbGU0JyksIGJ1ZmZlcik7XG5cbiAgICBleHBlY3QoaG9zdC5pc0ZpbGUobm9ybWFsaXplKCcvc3ViJykpKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3QoaG9zdC5pc0ZpbGUobm9ybWFsaXplKCcvc3ViMScpKSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KGhvc3QuaXNEaXJlY3Rvcnkobm9ybWFsaXplKCcvJykpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChob3N0LmlzRGlyZWN0b3J5KG5vcm1hbGl6ZSgnL3N1YicpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoaG9zdC5pc0RpcmVjdG9yeShub3JtYWxpemUoJy9zdWIvc3ViMScpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoaG9zdC5pc0RpcmVjdG9yeShub3JtYWxpemUoJy9zdWIvZmlsZTEnKSkpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChob3N0LmlzRGlyZWN0b3J5KG5vcm1hbGl6ZSgnL3N1Yi9zdWIxL2ZpbGUzJykpKS50b0JlKGZhbHNlKTtcbiAgfSk7XG5cbiAgaXQoJ21ha2VzIGV2ZXJ5IHBhdGggYWJzb2x1dGUnLCAoKSA9PiB7XG4gICAgY29uc3QgaG9zdCA9IG5ldyBTeW5jRGVsZWdhdGVIb3N0KG5ldyBTaW1wbGVNZW1vcnlIb3N0KCkpO1xuXG4gICAgY29uc3QgYnVmZmVyID0gc3RyaW5nVG9GaWxlQnVmZmVyKCdoZWxsbycpO1xuICAgIGNvbnN0IGJ1ZmZlcjIgPSBzdHJpbmdUb0ZpbGVCdWZmZXIoJ2hlbGxvIDInKTtcblxuICAgIGhvc3Qud3JpdGUobm9ybWFsaXplKCdmaWxlMScpLCBidWZmZXIpO1xuICAgIGhvc3Qud3JpdGUobm9ybWFsaXplKCcvc3ViL2ZpbGUyJyksIGJ1ZmZlcik7XG4gICAgaG9zdC53cml0ZShub3JtYWxpemUoJ3N1Yi9maWxlMicpLCBidWZmZXIyKTtcbiAgICBleHBlY3QoaG9zdC5pc0ZpbGUobm9ybWFsaXplKCdmaWxlMScpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoaG9zdC5pc0ZpbGUobm9ybWFsaXplKCcvZmlsZTEnKSkpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KGhvc3QuaXNGaWxlKG5vcm1hbGl6ZSgnL3N1Yi9maWxlMicpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoaG9zdC5yZWFkKG5vcm1hbGl6ZSgnc3ViL2ZpbGUyJykpKS50b0JlKGJ1ZmZlcjIpO1xuICAgIGV4cGVjdChob3N0LmlzRGlyZWN0b3J5KG5vcm1hbGl6ZSgnL3N1YicpKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoaG9zdC5pc0RpcmVjdG9yeShub3JtYWxpemUoJ3N1YicpKSkudG9CZSh0cnVlKTtcbiAgfSk7XG59KTtcbiJdfQ==
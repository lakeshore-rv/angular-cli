"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
// tslint:disable:non-null-operator no-big-function
const core_1 = require("@angular-devkit/core");
const exception_1 = require("../exception/exception");
const common_spec_1 = require("./common_spec");
const filesystem_1 = require("./filesystem");
const interface_1 = require("./interface");
const static_1 = require("./static");
const virtual_1 = require("./virtual");
function files(tree) {
    const treeFiles = [];
    tree.visit(x => treeFiles.push(x));
    return treeFiles;
}
describe('VirtualDirEntry', () => {
    common_spec_1.testTreeVisit({
        createTree: paths => {
            const tree = new virtual_1.VirtualTree();
            paths.forEach(path => tree.create(path, path));
            return tree;
        },
        sets: [
            {
                name: 'empty',
                files: [],
                visits: [
                    { root: '/', expected: [] },
                ],
            },
            {
                name: 'file at root',
                files: ['/file'],
                visits: [
                    { root: '/' },
                    { root: '/file', expected: [] },
                ],
            },
            {
                name: 'file under first level folder',
                // duplicate use case: folder of single file at root
                files: ['/folder/file'],
                visits: [
                    { root: '/' },
                    { root: '/folder', expected: ['/folder/file'] },
                    { root: '/folder/file', expected: [] },
                    { root: '/wrong', expected: [] },
                ],
            },
            {
                name: 'file under nested folder',
                // duplicate use case: nested folder of files
                files: ['/folder/nested_folder/file'],
                visits: [
                    { root: '/' },
                    { root: '/folder', expected: ['/folder/nested_folder/file'] },
                    { root: '/folder/nested_folder', expected: ['/folder/nested_folder/file'] },
                    { root: '/folder/nested_folder/file', expected: [] },
                ],
            },
            {
                name: 'nested folders',
                // duplicate use case: folder of folders at root
                // duplicate use case: folders of mixed
                files: [
                    '/folder/nested_folder0/file',
                    '/folder/nested_folder1/folder/file',
                    '/folder/nested_folder2/file',
                    '/folder/nested_folder2/folder/file',
                ],
                visits: [
                    { root: '/' },
                    { root: '/folder' },
                    { root: '/folder/nested_folder0', expected: ['/folder/nested_folder0/file'] },
                    { root: '/folder/nested_folder1', expected: ['/folder/nested_folder1/folder/file'] },
                    { root: '/folder/nested_folder1/folder', expected: ['/folder/nested_folder1/folder/file'] },
                    { root: '/folder/nested_folder2', expected: [
                            '/folder/nested_folder2/file',
                            '/folder/nested_folder2/folder/file',
                        ] },
                    { root: '/folder/nested_folder2/folder', expected: ['/folder/nested_folder2/folder/file'] },
                ],
            },
        ],
    });
});
describe('VirtualTree', () => {
    describe('exists()', () => {
        it('works', () => {
            const tree = new virtual_1.VirtualTree();
            tree.create('/some/file', 'some _content');
            expect(tree.exists('/some/file')).toBe(true);
            expect(tree.exists('/other/file')).toBe(false);
        });
    });
    describe('read()', () => {
        it('works', () => {
            const tree = new virtual_1.VirtualTree();
            tree.create('/some/file', 'some _content');
            expect(tree.read('/some/file').toString()).toBe('some _content');
            expect(tree.read('/other/file')).toBe(null);
        });
    });
    describe('files', () => {
        it('works', () => {
            const tree = new virtual_1.VirtualTree();
            tree.create('/some/file', 'some _content');
            tree.create('/some/other-file', 'some _content');
            tree.create('/some/other-file2', 'some _content');
            expect(files(tree)).toEqual([
                '/some/file', '/some/other-file', '/some/other-file2',
            ].map(core_1.normalize));
        });
    });
    describe('overwrite()', () => {
        it('works', () => {
            const tree = new virtual_1.VirtualTree();
            tree.create('/some/file', 'some content');
            tree.overwrite('/some/file', 'some other content');
            expect(tree.read('/some/file').toString()).toEqual('some other content');
        });
    });
    describe('insertContent()', () => {
        it('works', () => {
            const tree = new virtual_1.VirtualTree();
            tree.create('/some/file', 'some _content');
            const recorder = tree.beginUpdate('/some/file');
            recorder.insertLeft(4, ' hello');
            tree.commitUpdate(recorder);
            expect(tree.actions.length).toBe(2);
            expect(tree.read('/some/file').toString()).toBe('some hello _content');
        });
        it('throws when the file does not exist', () => {
            const tree = new virtual_1.VirtualTree();
            expect(() => tree.beginUpdate('/some/file'))
                .toThrow(new exception_1.FileDoesNotExistException('/some/file'));
        });
    });
    describe('combinatorics', () => {
        it('works', () => {
            const tree = new virtual_1.VirtualTree();
            tree.create('file1', 'some _content');
            tree.create('file2', 'some _content');
            tree.create('file3', 'some _content');
            const [tree1, tree2] = static_1.partition(tree, p => p == '/file1');
            expect(tree1.exists('file1')).toBe(true);
            expect(tree1.exists('file2')).toBe(false);
            expect(tree1.exists('file3')).toBe(false);
            expect(tree2.exists('file1')).toBe(false);
            expect(tree2.exists('file2')).toBe(true);
            expect(tree2.exists('file3')).toBe(true);
            const tree3 = static_1.merge(tree1, tree2, interface_1.MergeStrategy.Error);
            expect(files(tree3).sort()).toEqual(files(tree).sort());
        });
    });
    describe('optimize', () => {
        it('works', () => {
            const host = new core_1.virtualFs.test.TestHost({
                '/hello': 'world',
            });
            const tree = new filesystem_1.FileSystemTree(host);
            tree.create('/created', 'test 1');
            tree.create('/hello1', 'test 2');
            tree.overwrite('/hello1', 'beautiful world');
            tree.overwrite('/hello', 'beautiful world');
            expect(tree.actions.length).toBe(4);
            tree.optimize();
            expect(tree.actions.length).toBe(3);
        });
        it('works with branching', () => {
            const host = new core_1.virtualFs.test.TestHost({
                '/hello': '',
                '/sub/file1': '',
                '/sub/directory/file2': '',
            });
            const tree = new filesystem_1.FileSystemTree(host);
            tree.create('/test', 'testing 1 2');
            const recorder = tree.beginUpdate('/test');
            recorder.insertLeft(8, 'testing ');
            tree.commitUpdate(recorder);
            tree.overwrite('/hello', 'world');
            tree.overwrite('/test', 'test 3');
            const expected = ['/hello', '/sub/directory/file2', '/sub/file1', '/test'];
            expect(files(tree).sort()).toEqual(expected.map(core_1.normalize));
            const tree2 = tree.branch();
            expect(tree.actions.length).toBe(4);
            expect(tree2.actions.length).toBe(4);
            tree2.optimize();
            expect(tree.actions.length).toBe(4);
            expect(tree2.actions.length).toBe(2);
        });
    });
    describe('rename', () => {
        it('conflict fails', () => {
            const host = new core_1.virtualFs.test.TestHost({
                '/hello': 'world',
            });
            const tree = new filesystem_1.FileSystemTree(host);
            tree.create('/base', 'base content');
            const tree2 = new filesystem_1.FileSystemTree(host);
            tree2.create('/other-base', 'base content');
            tree2.rename('/other-base', '/base');
            expect(() => tree.merge(tree2))
                .toThrow(new exception_1.FileAlreadyExistException('/base'));
        });
        it('conflict works with overwrite', () => {
            const host = new core_1.virtualFs.test.TestHost({
                '/hello': 'world',
            });
            const tree = new filesystem_1.FileSystemTree(host);
            const tree2 = new filesystem_1.FileSystemTree(host);
            const newContent = 'new content';
            tree2.create('/greetings', newContent);
            tree2.rename('/greetings', '/hello');
            tree.merge(tree2, interface_1.MergeStrategy.Overwrite);
            const fileEntry = tree.get('/hello');
            expect(fileEntry.content.toString()).toEqual(newContent);
        });
        it('can rename files in base', () => {
            const host = new core_1.virtualFs.test.TestHost({
                '/hello': 'world',
            });
            const tree = new filesystem_1.FileSystemTree(host);
            tree.rename('/hello', '/world');
            const fileEntry = tree.get('/hello');
            const fileEntry2 = tree.get('/world');
            expect(fileEntry.content.toString())
                .toEqual(fileEntry2.content.toString());
        });
        it('can rename files created in staging', () => {
            const host = new core_1.virtualFs.test.TestHost({});
            const tree = new filesystem_1.FileSystemTree(host);
            tree.create('/hello', 'world');
            tree.rename('/hello', '/hello2');
            expect(tree.exists('/hello')).toBe(false);
            const fileEntry = tree.get('/hello2');
            expect(fileEntry.content.toString())
                .toEqual('world');
        });
        it('can rename branched and merged trees', () => {
            const host = new core_1.virtualFs.test.TestHost({
                '/hello': 'world',
            });
            const tree = new filesystem_1.FileSystemTree(host);
            const tree2 = tree.branch();
            expect(tree2.exists('/hello')).toBe(true);
            tree2.rename('/hello', '/hello2');
            expect(tree2.exists('/hello2')).toBe(true);
            tree.merge(tree2);
            expect(tree.exists('/hello2')).toBe(true);
            const fileEntry = tree.get('/hello2');
            expect(fileEntry.content.toString())
                .toEqual('world');
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlydHVhbF9zcGVjLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9lcm5pZWRhdmlzL0NvZGUvYW5ndWxhci1jbGkvIiwic291cmNlcyI6WyJwYWNrYWdlcy9hbmd1bGFyX2RldmtpdC9zY2hlbWF0aWNzL3NyYy90cmVlL3ZpcnR1YWxfc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7R0FNRztBQUNILG1EQUFtRDtBQUNuRCwrQ0FBNEQ7QUFDNUQsc0RBQThGO0FBQzlGLCtDQUE4QztBQUM5Qyw2Q0FBOEM7QUFDOUMsMkNBQTZEO0FBQzdELHFDQUE0QztBQUM1Qyx1Q0FBd0M7QUFHeEMsZUFBZSxJQUFVO0lBQ3ZCLE1BQU0sU0FBUyxHQUFhLEVBQUUsQ0FBQztJQUMvQixJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRW5DLE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUM7QUFHRCxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO0lBQy9CLDJCQUFhLENBQUM7UUFDWixVQUFVLEVBQUUsS0FBSyxDQUFDLEVBQUU7WUFDbEIsTUFBTSxJQUFJLEdBQUcsSUFBSSxxQkFBVyxFQUFFLENBQUM7WUFDL0IsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7WUFFL0MsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBQ0QsSUFBSSxFQUFFO1lBQ0o7Z0JBQ0UsSUFBSSxFQUFFLE9BQU87Z0JBQ2IsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsTUFBTSxFQUFFO29CQUNOLEVBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFDO2lCQUMxQjthQUNGO1lBRUQ7Z0JBQ0UsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLEtB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MUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFM0MsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNsQixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMxQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3RDLE1BQU0sQ0FBRSxTQUF1QixDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztpQkFDaEQsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3RCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vYW5ndWxhci5pby9saWNlbnNlXG4gKi9cbi8vIHRzbGludDpkaXNhYmxlOm5vbi1udWxsLW9wZXJhdG9yIG5vLWJpZy1mdW5jdGlvblxuaW1wb3J0IHsgbm9ybWFsaXplLCB2aXJ0dWFsRnMgfSBmcm9tICdAYW5ndWxhci1kZXZraXQvY29yZSc7XG5pbXBvcnQgeyBGaWxlQWxyZWFkeUV4aXN0RXhjZXB0aW9uLCBGaWxlRG9lc05vdEV4aXN0RXhjZXB0aW9uIH0gZnJvbSAnLi4vZXhjZXB0aW9uL2V4Y2VwdGlvbic7XG5pbXBvcnQgeyB0ZXN0VHJlZVZpc2l0IH0gZnJvbSAnLi9jb21tb25fc3BlYyc7XG5pbXBvcnQgeyBGaWxlU3lzdGVtVHJlZSB9IGZyb20gJy4vZmlsZXN5c3RlbSc7XG5pbXBvcnQgeyBGaWxlRW50cnksIE1lcmdlU3RyYXRlZ3ksIFRyZWUgfSBmcm9tICcuL2ludGVyZmFjZSc7XG5pbXBvcnQgeyBtZXJnZSwgcGFydGl0aW9uIH0gZnJvbSAnLi9zdGF0aWMnO1xuaW1wb3J0IHsgVmlydHVhbFRyZWUgfSBmcm9tICcuL3ZpcnR1YWwnO1xuXG5cbmZ1bmN0aW9uIGZpbGVzKHRyZWU6IFRyZWUpIHtcbiAgY29uc3QgdHJlZUZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuICB0cmVlLnZpc2l0KHggPT4gdHJlZUZpbGVzLnB1c2goeCkpO1xuXG4gIHJldHVybiB0cmVlRmlsZXM7XG59XG5cblxuZGVzY3JpYmUoJ1ZpcnR1YWxEaXJFbnRyeScsICgpID0+IHtcbiAgdGVzdFRyZWVWaXNpdCh7XG4gICAgY3JlYXRlVHJlZTogcGF0aHMgPT4ge1xuICAgICAgY29uc3QgdHJlZSA9IG5ldyBWaXJ0dWFsVHJlZSgpO1xuICAgICAgcGF0aHMuZm9yRWFjaChwYXRoID0+IHRyZWUuY3JlYXRlKHBhdGgsIHBhdGgpKTtcblxuICAgICAgcmV0dXJuIHRyZWU7XG4gICAgfSxcbiAgICBzZXRzOiBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdlbXB0eScsXG4gICAgICAgIGZpbGVzOiBbXSxcbiAgICAgICAgdmlzaXRzOiBbXG4gICAgICAgICAge3Jvb3Q6ICcvJywgZXhwZWN0ZWQ6IFtdfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG5cbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2ZpbGUgYXQgcm9vdCcsXG4gICAgICAgIGZpbGVzOiBbJy9maWxlJ10sXG4gICAgICAgIHZpc2l0czogW1xuICAgICAgICAgIHtyb290OiAnLyd9LFxuICAgICAgICAgIHtyb290OiAnL2ZpbGUnLCBleHBlY3RlZDogW119LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2ZpbGUgdW5kZXIgZmlyc3QgbGV2ZWwgZm9sZGVyJyxcbiAgICAgICAgLy8gZHVwbGljYXRlIHVzZSBjYXNlOiBmb2xkZXIgb2Ygc2luZ2xlIGZpbGUgYXQgcm9vdFxuICAgICAgICBmaWxlczogWycvZm9sZGVyL2ZpbGUnXSxcbiAgICAgICAgdmlzaXRzOiBbXG4gICAgICAgICAge3Jvb3Q6ICcvJ30sXG4gICAgICAgICAge3Jvb3Q6ICcvZm9sZGVyJywgZXhwZWN0ZWQ6IFsnL2ZvbGRlci9maWxlJ119LFxuICAgICAgICAgIHtyb290OiAnL2ZvbGRlci9maWxlJywgZXhwZWN0ZWQ6IFtdfSxcbiAgICAgICAgICB7cm9vdDogJy93cm9uZycsIGV4cGVjdGVkOiBbXX0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnZmlsZSB1bmRlciBuZXN0ZWQgZm9sZGVyJyxcbiAgICAgICAgLy8gZHVwbGljYXRlIHVzZSBjYXNlOiBuZXN0ZWQgZm9sZGVyIG9mIGZpbGVzXG4gICAgICAgIGZpbGVzOiBbJy9mb2xkZXIvbmVzdGVkX2ZvbGRlci9maWxlJ10sXG4gICAgICAgIHZpc2l0czogW1xuICAgICAgICAgIHtyb290OiAnLyd9LFxuICAgICAgICAgIHtyb290OiAnL2ZvbGRlcicsIGV4cGVjdGVkOiBbJy9mb2xkZXIvbmVzdGVkX2ZvbGRlci9maWxlJ119LFxuICAgICAgICAgIHtyb290OiAnL2ZvbGRlci9uZXN0ZWRfZm9sZGVyJywgZXhwZWN0ZWQ6IFsnL2ZvbGRlci9uZXN0ZWRfZm9sZGVyL2ZpbGUnXX0sXG4gICAgICAgICAge3Jvb3Q6ICcvZm9sZGVyL25lc3RlZF9mb2xkZXIvZmlsZScsIGV4cGVjdGVkOiBbXX0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICduZXN0ZWQgZm9sZGVycycsXG4gICAgICAgIC8vIGR1cGxpY2F0ZSB1c2UgY2FzZTogZm9sZGVyIG9mIGZvbGRlcnMgYXQgcm9vdFxuICAgICAgICAvLyBkdXBsaWNhdGUgdXNlIGNhc2U6IGZvbGRlcnMgb2YgbWl4ZWRcbiAgICAgICAgZmlsZXM6IFtcbiAgICAgICAgICAnL2ZvbGRlci9uZXN0ZWRfZm9sZGVyMC9maWxlJyxcbiAgICAgICAgICAnL2ZvbGRlci9uZXN0ZWRfZm9sZGVyMS9mb2xkZXIvZmlsZScsXG4gICAgICAgICAgJy9mb2xkZXIvbmVzdGVkX2ZvbGRlcjIvZmlsZScsXG4gICAgICAgICAgJy9mb2xkZXIvbmVzdGVkX2ZvbGRlcjIvZm9sZGVyL2ZpbGUnLFxuICAgICAgICBdLFxuICAgICAgICB2aXNpdHM6IFtcbiAgICAgICAgICB7cm9vdDogJy8nfSxcbiAgICAgICAgICB7cm9vdDogJy9mb2xkZXInfSxcbiAgICAgICAgICB7cm9vdDogJy9mb2xkZXIvbmVzdGVkX2ZvbGRlcjAnLCBleHBlY3RlZDogWycvZm9sZGVyL25lc3RlZF9mb2xkZXIwL2ZpbGUnXX0sXG4gICAgICAgICAge3Jvb3Q6ICcvZm9sZGVyL25lc3RlZF9mb2xkZXIxJywgZXhwZWN0ZWQ6IFsnL2ZvbGRlci9uZXN0ZWRfZm9sZGVyMS9mb2xkZXIvZmlsZSddfSxcbiAgICAgICAgICB7cm9vdDogJy9mb2xkZXIvbmVzdGVkX2ZvbGRlcjEvZm9sZGVyJywgZXhwZWN0ZWQ6IFsnL2ZvbGRlci9uZXN0ZWRfZm9sZGVyMS9mb2xkZXIvZmlsZSddfSxcbiAgICAgICAgICB7cm9vdDogJy9mb2xkZXIvbmVzdGVkX2ZvbGRlcjInLCBleHBlY3RlZDogW1xuICAgICAgICAgICAgJy9mb2xkZXIvbmVzdGVkX2ZvbGRlcjIvZmlsZScsXG4gICAgICAgICAgICAnL2ZvbGRlci9uZXN0ZWRfZm9sZGVyMi9mb2xkZXIvZmlsZScsXG4gICAgICAgICAgXX0sXG4gICAgICAgICAge3Jvb3Q6ICcvZm9sZGVyL25lc3RlZF9mb2xkZXIyL2ZvbGRlcicsIGV4cGVjdGVkOiBbJy9mb2xkZXIvbmVzdGVkX2ZvbGRlcjIvZm9sZGVyL2ZpbGUnXX0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xufSk7XG5cblxuZGVzY3JpYmUoJ1ZpcnR1YWxUcmVlJywgKCkgPT4ge1xuICBkZXNjcmliZSgnZXhpc3RzKCknLCAoKSA9PiB7XG4gICAgaXQoJ3dvcmtzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdHJlZSA9IG5ldyBWaXJ0dWFsVHJlZSgpO1xuICAgICAgdHJlZS5jcmVhdGUoJy9zb21lL2ZpbGUnLCAnc29tZSBfY29udGVudCcpO1xuICAgICAgZXhwZWN0KHRyZWUuZXhpc3RzKCcvc29tZS9maWxlJykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QodHJlZS5leGlzdHMoJy9vdGhlci9maWxlJykpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ3JlYWQoKScsICgpID0+IHtcbiAgICBpdCgnd29ya3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmVlID0gbmV3IFZpcnR1YWxUcmVlKCk7XG4gICAgICB0cmVlLmNyZWF0ZSgnL3NvbWUvZmlsZScsICdzb21lIF9jb250ZW50Jyk7XG4gICAgICBleHBlY3QodHJlZS5yZWFkKCcvc29tZS9maWxlJykgIS50b1N0cmluZygpKS50b0JlKCdzb21lIF9jb250ZW50Jyk7XG4gICAgICBleHBlY3QodHJlZS5yZWFkKCcvb3RoZXIvZmlsZScpKS50b0JlKG51bGwpO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2ZpbGVzJywgKCkgPT4ge1xuICAgIGl0KCd3b3JrcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyZWUgPSBuZXcgVmlydHVhbFRyZWUoKTtcbiAgICAgIHRyZWUuY3JlYXRlKCcvc29tZS9maWxlJywgJ3NvbWUgX2NvbnRlbnQnKTtcbiAgICAgIHRyZWUuY3JlYXRlKCcvc29tZS9vdGhlci1maWxlJywgJ3NvbWUgX2NvbnRlbnQnKTtcbiAgICAgIHRyZWUuY3JlYXRlKCcvc29tZS9vdGhlci1maWxlMicsICdzb21lIF9jb250ZW50Jyk7XG5cbiAgICAgIGV4cGVjdChmaWxlcyh0cmVlKSkudG9FcXVhbChbXG4gICAgICAgICcvc29tZS9maWxlJywgJy9zb21lL290aGVyLWZpbGUnLCAnL3NvbWUvb3RoZXItZmlsZTInLFxuICAgICAgXS5tYXAobm9ybWFsaXplKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdvdmVyd3JpdGUoKScsICgpID0+IHtcbiAgICBpdCgnd29ya3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmVlID0gbmV3IFZpcnR1YWxUcmVlKCk7XG4gICAgICB0cmVlLmNyZWF0ZSgnL3NvbWUvZmlsZScsICdzb21lIGNvbnRlbnQnKTtcbiAgICAgIHRyZWUub3ZlcndyaXRlKCcvc29tZS9maWxlJywgJ3NvbWUgb3RoZXIgY29udGVudCcpO1xuXG4gICAgICBleHBlY3QodHJlZS5yZWFkKCcvc29tZS9maWxlJykgIS50b1N0cmluZygpKS50b0VxdWFsKCdzb21lIG90aGVyIGNvbnRlbnQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2luc2VydENvbnRlbnQoKScsICgpID0+IHtcbiAgICBpdCgnd29ya3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmVlID0gbmV3IFZpcnR1YWxUcmVlKCk7XG4gICAgICB0cmVlLmNyZWF0ZSgnL3NvbWUvZmlsZScsICdzb21lIF9jb250ZW50Jyk7XG4gICAgICBjb25zdCByZWNvcmRlciA9IHRyZWUuYmVnaW5VcGRhdGUoJy9zb21lL2ZpbGUnKTtcbiAgICAgIHJlY29yZGVyLmluc2VydExlZnQoNCwgJyBoZWxsbycpO1xuICAgICAgdHJlZS5jb21taXRVcGRhdGUocmVjb3JkZXIpO1xuXG4gICAgICBleHBlY3QodHJlZS5hY3Rpb25zLmxlbmd0aCkudG9CZSgyKTtcbiAgICAgIGV4cGVjdCh0cmVlLnJlYWQoJy9zb21lL2ZpbGUnKSAhLnRvU3RyaW5nKCkpLnRvQmUoJ3NvbWUgaGVsbG8gX2NvbnRlbnQnKTtcbiAgICB9KTtcblxuICAgIGl0KCd0aHJvd3Mgd2hlbiB0aGUgZmlsZSBkb2VzIG5vdCBleGlzdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyZWUgPSBuZXcgVmlydHVhbFRyZWUoKTtcbiAgICAgIGV4cGVjdCgoKSA9PiB0cmVlLmJlZ2luVXBkYXRlKCcvc29tZS9maWxlJykpXG4gICAgICAgIC50b1Rocm93KG5ldyBGaWxlRG9lc05vdEV4aXN0RXhjZXB0aW9uKCcvc29tZS9maWxlJykpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY29tYmluYXRvcmljcycsICgpID0+IHtcbiAgICBpdCgnd29ya3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmVlID0gbmV3IFZpcnR1YWxUcmVlKCk7XG4gICAgICB0cmVlLmNyZWF0ZSgnZmlsZTEnLCAnc29tZSBfY29udGVudCcpO1xuICAgICAgdHJlZS5jcmVhdGUoJ2ZpbGUyJywgJ3NvbWUgX2NvbnRlbnQnKTtcbiAgICAgIHRyZWUuY3JlYXRlKCdmaWxlMycsICdzb21lIF9jb250ZW50Jyk7XG5cbiAgICAgIGNvbnN0IFt0cmVlMSwgdHJlZTJdID0gcGFydGl0aW9uKHRyZWUsIHAgPT4gcCA9PSAnL2ZpbGUxJyk7XG4gICAgICBleHBlY3QodHJlZTEuZXhpc3RzKCdmaWxlMScpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHRyZWUxLmV4aXN0cygnZmlsZTInKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodHJlZTEuZXhpc3RzKCdmaWxlMycpKS50b0JlKGZhbHNlKTtcblxuICAgICAgZXhwZWN0KHRyZWUyLmV4aXN0cygnZmlsZTEnKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodHJlZTIuZXhpc3RzKCdmaWxlMicpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHRyZWUyLmV4aXN0cygnZmlsZTMnKSkudG9CZSh0cnVlKTtcblxuICAgICAgY29uc3QgdHJlZTMgPSBtZXJnZSh0cmVlMSwgdHJlZTIsIE1lcmdlU3RyYXRlZ3kuRXJyb3IpO1xuICAgICAgZXhwZWN0KGZpbGVzKHRyZWUzKS5zb3J0KCkpLnRvRXF1YWwoZmlsZXModHJlZSkuc29ydCgpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ29wdGltaXplJywgKCkgPT4ge1xuICAgIGl0KCd3b3JrcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGhvc3QgPSBuZXcgdmlydHVhbEZzLnRlc3QuVGVzdEhvc3Qoe1xuICAgICAgICAnL2hlbGxvJzogJ3dvcmxkJyxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdHJlZSA9IG5ldyBGaWxlU3lzdGVtVHJlZShob3N0KTtcblxuICAgICAgdHJlZS5jcmVhdGUoJy9jcmVhdGVkJywgJ3Rlc3QgMScpO1xuICAgICAgdHJlZS5jcmVhdGUoJy9oZWxsbzEnLCAndGVzdCAyJyk7XG4gICAgICB0cmVlLm92ZXJ3cml0ZSgnL2hlbGxvMScsICdiZWF1dGlmdWwgd29ybGQnKTtcbiAgICAgIHRyZWUub3ZlcndyaXRlKCcvaGVsbG8nLCAnYmVhdXRpZnVsIHdvcmxkJyk7XG5cbiAgICAgIGV4cGVjdCh0cmVlLmFjdGlvbnMubGVuZ3RoKS50b0JlKDQpO1xuICAgICAgdHJlZS5vcHRpbWl6ZSgpO1xuICAgICAgZXhwZWN0KHRyZWUuYWN0aW9ucy5sZW5ndGgpLnRvQmUoMyk7XG4gICAgfSk7XG5cbiAgICBpdCgnd29ya3Mgd2l0aCBicmFuY2hpbmcnLCAoKSA9PiB7XG4gICAgICBjb25zdCBob3N0ID0gbmV3IHZpcnR1YWxGcy50ZXN0LlRlc3RIb3N0KHtcbiAgICAgICAgJy9oZWxsbyc6ICcnLFxuICAgICAgICAnL3N1Yi9maWxlMSc6ICcnLFxuICAgICAgICAnL3N1Yi9kaXJlY3RvcnkvZmlsZTInOiAnJyxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdHJlZSA9IG5ldyBGaWxlU3lzdGVtVHJlZShob3N0KTtcblxuICAgICAgdHJlZS5jcmVhdGUoJy90ZXN0JywgJ3Rlc3RpbmcgMSAyJyk7XG4gICAgICBjb25zdCByZWNvcmRlciA9IHRyZWUuYmVnaW5VcGRhdGUoJy90ZXN0Jyk7XG4gICAgICByZWNvcmRlci5pbnNlcnRMZWZ0KDgsICd0ZXN0aW5nICcpO1xuICAgICAgdHJlZS5jb21taXRVcGRhdGUocmVjb3JkZXIpO1xuICAgICAgdHJlZS5vdmVyd3JpdGUoJy9oZWxsbycsICd3b3JsZCcpO1xuICAgICAgdHJlZS5vdmVyd3JpdGUoJy90ZXN0JywgJ3Rlc3QgMycpO1xuXG4gICAgICBjb25zdCBleHBlY3RlZCA9IFsnL2hlbGxvJywgJy9zdWIvZGlyZWN0b3J5L2ZpbGUyJywgJy9zdWIvZmlsZTEnLCAnL3Rlc3QnXTtcbiAgICAgIGV4cGVjdChmaWxlcyh0cmVlKS5zb3J0KCkpLnRvRXF1YWwoZXhwZWN0ZWQubWFwKG5vcm1hbGl6ZSkpO1xuXG4gICAgICBjb25zdCB0cmVlMiA9IHRyZWUuYnJhbmNoKCkgYXMgVmlydHVhbFRyZWU7XG4gICAgICBleHBlY3QodHJlZS5hY3Rpb25zLmxlbmd0aCkudG9CZSg0KTtcbiAgICAgIGV4cGVjdCh0cmVlMi5hY3Rpb25zLmxlbmd0aCkudG9CZSg0KTtcblxuICAgICAgdHJlZTIub3B0aW1pemUoKTtcbiAgICAgIGV4cGVjdCh0cmVlLmFjdGlvbnMubGVuZ3RoKS50b0JlKDQpO1xuICAgICAgZXhwZWN0KHRyZWUyLmFjdGlvbnMubGVuZ3RoKS50b0JlKDIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVuYW1lJywgKCkgPT4ge1xuICAgIGl0KCdjb25mbGljdCBmYWlscycsICgpID0+IHtcbiAgICAgIGNvbnN0IGhvc3QgPSBuZXcgdmlydHVhbEZzLnRlc3QuVGVzdEhvc3Qoe1xuICAgICAgICAnL2hlbGxvJzogJ3dvcmxkJyxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdHJlZSA9IG5ldyBGaWxlU3lzdGVtVHJlZShob3N0KTtcbiAgICAgIHRyZWUuY3JlYXRlKCcvYmFzZScsICdiYXNlIGNvbnRlbnQnKTtcbiAgICAgIGNvbnN0IHRyZWUyID0gbmV3IEZpbGVTeXN0ZW1UcmVlKGhvc3QpO1xuICAgICAgdHJlZTIuY3JlYXRlKCcvb3RoZXItYmFzZScsICdiYXNlIGNvbnRlbnQnKTtcbiAgICAgIHRyZWUyLnJlbmFtZSgnL290aGVyLWJhc2UnLCAnL2Jhc2UnKTtcblxuICAgICAgZXhwZWN0KCgpID0+IHRyZWUubWVyZ2UodHJlZTIpKVxuICAgICAgICAudG9UaHJvdyhuZXcgRmlsZUFscmVhZHlFeGlzdEV4Y2VwdGlvbignL2Jhc2UnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnY29uZmxpY3Qgd29ya3Mgd2l0aCBvdmVyd3JpdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBob3N0ID0gbmV3IHZpcnR1YWxGcy50ZXN0LlRlc3RIb3N0KHtcbiAgICAgICAgJy9oZWxsbyc6ICd3b3JsZCcsXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHRyZWUgPSBuZXcgRmlsZVN5c3RlbVRyZWUoaG9zdCk7XG5cbiAgICAgIGNvbnN0IHRyZWUyID0gbmV3IEZpbGVTeXN0ZW1UcmVlKGhvc3QpO1xuICAgICAgY29uc3QgbmV3Q29udGVudCA9ICduZXcgY29udGVudCc7XG4gICAgICB0cmVlMi5jcmVhdGUoJy9ncmVldGluZ3MnLCBuZXdDb250ZW50KTtcbiAgICAgIHRyZWUyLnJlbmFtZSgnL2dyZWV0aW5ncycsICcvaGVsbG8nKTtcblxuICAgICAgdHJlZS5tZXJnZSh0cmVlMiwgTWVyZ2VTdHJhdGVneS5PdmVyd3JpdGUpO1xuICAgICAgY29uc3QgZmlsZUVudHJ5ID0gdHJlZS5nZXQoJy9oZWxsbycpO1xuICAgICAgZXhwZWN0KChmaWxlRW50cnkgYXMgRmlsZUVudHJ5KS5jb250ZW50LnRvU3RyaW5nKCkpLnRvRXF1YWwobmV3Q29udGVudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnY2FuIHJlbmFtZSBmaWxlcyBpbiBiYXNlJywgKCkgPT4ge1xuICAgICAgY29uc3QgaG9zdCA9IG5ldyB2aXJ0dWFsRnMudGVzdC5UZXN0SG9zdCh7XG4gICAgICAgICcvaGVsbG8nOiAnd29ybGQnLFxuICAgICAgfSk7XG4gICAgICBjb25zdCB0cmVlID0gbmV3IEZpbGVTeXN0ZW1UcmVlKGhvc3QpO1xuXG4gICAgICB0cmVlLnJlbmFtZSgnL2hlbGxvJywgJy93b3JsZCcpO1xuXG4gICAgICBjb25zdCBmaWxlRW50cnkgPSB0cmVlLmdldCgnL2hlbGxvJyk7XG4gICAgICBjb25zdCBmaWxlRW50cnkyID0gdHJlZS5nZXQoJy93b3JsZCcpO1xuICAgICAgZXhwZWN0KChmaWxlRW50cnkgYXMgRmlsZUVudHJ5KS5jb250ZW50LnRvU3RyaW5nKCkpXG4gICAgICAgIC50b0VxdWFsKChmaWxlRW50cnkyIGFzIEZpbGVFbnRyeSkuY29udGVudC50b1N0cmluZygpKTtcbiAgICB9KTtcblxuICAgIGl0KCdjYW4gcmVuYW1lIGZpbGVzIGNyZWF0ZWQgaW4gc3RhZ2luZycsICgpID0+IHtcbiAgICAgIGNvbnN0IGhvc3QgPSBuZXcgdmlydHVhbEZzLnRlc3QuVGVzdEhvc3Qoe1xuICAgICAgfSk7XG4gICAgICBjb25zdCB0cmVlID0gbmV3IEZpbGVTeXN0ZW1UcmVlKGhvc3QpO1xuXG4gICAgICB0cmVlLmNyZWF0ZSgnL2hlbGxvJywgJ3dvcmxkJyk7XG4gICAgICB0cmVlLnJlbmFtZSgnL2hlbGxvJywgJy9oZWxsbzInKTtcblxuICAgICAgZXhwZWN0KHRyZWUuZXhpc3RzKCcvaGVsbG8nKSkudG9CZShmYWxzZSk7XG4gICAgICBjb25zdCBmaWxlRW50cnkgPSB0cmVlLmdldCgnL2hlbGxvMicpO1xuICAgICAgZXhwZWN0KChmaWxlRW50cnkgYXMgRmlsZUVudHJ5KS5jb250ZW50LnRvU3RyaW5nKCkpXG4gICAgICAgIC50b0VxdWFsKCd3b3JsZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NhbiByZW5hbWUgYnJhbmNoZWQgYW5kIG1lcmdlZCB0cmVlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGhvc3QgPSBuZXcgdmlydHVhbEZzLnRlc3QuVGVzdEhvc3Qoe1xuICAgICAgICAnL2hlbGxvJzogJ3dvcmxkJyxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdHJlZSA9IG5ldyBGaWxlU3lzdGVtVHJlZShob3N0KTtcbiAgICAgIGNvbnN0IHRyZWUyID0gdHJlZS5icmFuY2goKTtcblxuICAgICAgZXhwZWN0KHRyZWUyLmV4aXN0cygnL2hlbGxvJykpLnRvQmUodHJ1ZSk7XG4gICAgICB0cmVlMi5yZW5hbWUoJy9oZWxsbycsICcvaGVsbG8yJyk7XG4gICAgICBleHBlY3QodHJlZTIuZXhpc3RzKCcvaGVsbG8yJykpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIHRyZWUubWVyZ2UodHJlZTIpO1xuICAgICAgZXhwZWN0KHRyZWUuZXhpc3RzKCcvaGVsbG8yJykpLnRvQmUodHJ1ZSk7XG4gICAgICBjb25zdCBmaWxlRW50cnkgPSB0cmVlLmdldCgnL2hlbGxvMicpO1xuICAgICAgZXhwZWN0KChmaWxlRW50cnkgYXMgRmlsZUVudHJ5KS5jb250ZW50LnRvU3RyaW5nKCkpXG4gICAgICAgIC50b0VxdWFsKCd3b3JsZCcpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
// tslint:disable:no-any no-big-function no-implicit-dependencies
const core_1 = require("@angular-devkit/core");
const schematics_1 = require("@angular-devkit/schematics");
const tools_1 = require("@angular-devkit/schematics/tools");
const path = require("path");
const rxjs_1 = require("rxjs");
describe('FileSystemEngineHost', () => {
    const devkitRoot = global._DevKitRoot;
    const root = path.join(devkitRoot, 'tests/angular_devkit/schematics/tools/file-system-engine-host');
    it('works', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('works');
        const schematic1 = engine.createSchematic('schematic1', testCollection);
        expect(schematic1.description.name).toBe('schematic1');
    });
    it('understands aliases', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('aliases');
        const schematic1 = engine.createSchematic('alias1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
    });
    it('understands multiple aliases for a single schematic', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('aliases-many');
        const schematic1 = engine.createSchematic('alias1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
        const schematic2 = engine.createSchematic('alias2', testCollection);
        expect(schematic2).not.toBeNull();
        expect(schematic2.description.name).toBe('schematic1');
        const schematic3 = engine.createSchematic('alias3', testCollection);
        expect(schematic3).not.toBeNull();
        expect(schematic3.description.name).toBe('schematic1');
    });
    it('allows dupe aliases for a single schematic', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('aliases-dupe');
        const schematic1 = engine.createSchematic('alias1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
        const schematic2 = engine.createSchematic('alias2', testCollection);
        expect(schematic2).not.toBeNull();
        expect(schematic2.description.name).toBe('schematic1');
        const schematic3 = engine.createSchematic('alias3', testCollection);
        expect(schematic3).not.toBeNull();
        expect(schematic3.description.name).toBe('schematic1');
    });
    it('lists schematics but not aliases', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('aliases');
        const names = testCollection.listSchematicNames();
        expect(names).not.toBeNull();
        expect(names[0]).toBe('schematic1');
        expect(names[1]).toBe('schematic2');
    });
    it('extends a collection with string', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('extends-basic-string');
        expect(testCollection.baseDescriptions).not.toBeUndefined();
        expect(testCollection.baseDescriptions
            && testCollection.baseDescriptions.length).toBe(1);
        const schematic1 = engine.createSchematic('schematic1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
        const schematic2 = engine.createSchematic('schematic2', testCollection);
        expect(schematic2).not.toBeNull();
        expect(schematic2.description.name).toBe('schematic2');
        const names = testCollection.listSchematicNames();
        expect(names.length).toBe(2);
    });
    it('extends a collection with array', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('extends-basic');
        expect(testCollection.baseDescriptions).not.toBeUndefined();
        expect(testCollection.baseDescriptions
            && testCollection.baseDescriptions.length).toBe(1);
        const schematic1 = engine.createSchematic('schematic1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
        const schematic2 = engine.createSchematic('schematic2', testCollection);
        expect(schematic2).not.toBeNull();
        expect(schematic2.description.name).toBe('schematic2');
        const names = testCollection.listSchematicNames();
        expect(names.length).toBe(2);
    });
    it('extends a collection with full depth', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('extends-deep');
        expect(testCollection.baseDescriptions).not.toBeUndefined();
        expect(testCollection.baseDescriptions
            && testCollection.baseDescriptions.length).toBe(2);
        const schematic1 = engine.createSchematic('schematic1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
        const schematic2 = engine.createSchematic('schematic2', testCollection);
        expect(schematic2).not.toBeNull();
        expect(schematic2.description.name).toBe('schematic2');
        const names = testCollection.listSchematicNames();
        expect(names.length).toBe(2);
    });
    it('replaces base schematics when extending', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('extends-replace');
        expect(testCollection.baseDescriptions).not.toBeUndefined();
        expect(testCollection.baseDescriptions
            && testCollection.baseDescriptions.length).toBe(1);
        const schematic1 = engine.createSchematic('schematic1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
        expect(schematic1.description.description).toBe('replaced');
        const names = testCollection.listSchematicNames();
        expect(names).not.toBeNull();
        expect(names.length).toBe(1);
    });
    it('extends multiple collections', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const testCollection = engine.createCollection('extends-multiple');
        expect(testCollection.baseDescriptions).not.toBeUndefined();
        expect(testCollection.baseDescriptions
            && testCollection.baseDescriptions.length).toBe(4);
        const schematic1 = engine.createSchematic('schematic1', testCollection);
        expect(schematic1).not.toBeNull();
        expect(schematic1.description.name).toBe('schematic1');
        expect(schematic1.description.description).toBe('replaced');
        const schematic2 = engine.createSchematic('schematic2', testCollection);
        expect(schematic2).not.toBeNull();
        expect(schematic2.description.name).toBe('schematic2');
        const names = testCollection.listSchematicNames();
        expect(names).not.toBeNull();
        expect(names.length).toBe(2);
    });
    it('errors on simple circular collections', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        expect(() => engine.createCollection('extends-circular')).toThrow();
    });
    it('errors on complex circular collections', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        expect(() => engine.createCollection('extends-circular-multiple')).toThrow();
    });
    it('errors on deep circular collections', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        expect(() => engine.createCollection('extends-circular-deep')).toThrow();
    });
    it('errors on invalid aliases', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        expect(() => engine.createCollection('invalid-aliases')).toThrow();
    });
    it('errors on invalid aliases (2)', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        expect(() => engine.createCollection('invalid-aliases-2')).toThrow();
    });
    it('does not list hidden schematics', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const collection = engine.createCollection('hidden-schematics');
        expect(collection.listSchematicNames()).toEqual([
            'schematic-1',
            'schematic-2',
        ]);
    });
    it('does not list private schematics', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const collection = engine.createCollection('private-schematics');
        expect(collection.listSchematicNames()).toEqual([
            'schematic-1',
            'schematic-2',
        ]);
    });
    it('cannot instanciate a private schematic', () => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const collection = engine.createCollection('private-schematics');
        expect(() => engine.createSchematic('schematic-1', collection)).not.toThrow();
        expect(() => engine.createSchematic('private-schematic', collection)).toThrow();
        expect(() => collection.createSchematic('private-schematic')).toThrow();
    });
    it('allows extra properties on schema', done => {
        const engineHost = new tools_1.FileSystemEngineHost(root);
        const engine = new schematics_1.SchematicEngine(engineHost);
        const host = new core_1.virtualFs.test.TestHost();
        const collection = engine.createCollection('extra-properties');
        const schematic = collection.createSchematic('schematic1');
        schematic.call({}, rxjs_1.of(new schematics_1.HostTree(host))).toPromise()
            .then(tree => {
            return new schematics_1.HostSink(host).commit(tree).toPromise();
        })
            .then(() => {
            expect(host.files).toEqual(['/extra-schematic']);
            expect(host.sync.read(core_1.normalize('/extra-schematic')).toString())
                .toEqual('extra-collection');
        })
            .then(done, done.fail);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS1zeXN0ZW0tZW5naW5lLWhvc3Rfc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvZXJuaWVkYXZpcy9Db2RlL2FuZ3VsYXItY2xpLyIsInNvdXJjZXMiOlsicGFja2FnZXMvYW5ndWxhcl9kZXZraXQvc2NoZW1hdGljcy90b29scy9maWxlLXN5c3RlbS1lbmdpbmUtaG9zdF9zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7OztHQU1HO0FBQ0gsaUVBQWlFO0FBQ2pFLCtDQUE0RDtBQUM1RCwyREFBaUY7QUFDakYsNERBQXdFO0FBQ3hFLDZCQUE2QjtBQUM3QiwrQkFBMEM7QUFHMUMsUUFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtJQUNwQyxNQUFNLFVBQVUsR0FBSSxNQUFjLENBQUMsV0FBVyxDQUFDO0lBQy9DLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQ3BCLFVBQVUsRUFDViwrREFBK0QsQ0FDaEUsQ0FBQztJQUVGLEVBQUUsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO1FBQ2YsTUFBTSxVQUFVLEdBQUcsSUFBSSw0QkFBb0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsRCxNQUFNLE1BQU0sR0FBRyxJQUFJLDRCQUFlLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFL0MsTUFBTSxjQUFjLEdBQUcsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3hELE1BQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxlQUFlLENBQUMsWUFBWSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBRXhFLE1BQU0sQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUN6RCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7UUFDN0IsTUFBTSxVQUFVLEdBQUcsSUFBSSw0QkFBb0IsQ0FBQyxJQUFJLENB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SSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3JELENBQUMsQ0FBQzthQUNELElBQUksQ0FBQyxHQUFHLEVBQUU7WUFDVCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQWlCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO2lCQUM3RCxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUNqQyxDQUFDLENBQUM7YUFDRCxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzQixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEdvb2dsZSBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYW4gTUlULXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4gYmVcbiAqIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgYXQgaHR0cHM6Ly9hbmd1bGFyLmlvL2xpY2Vuc2VcbiAqL1xuLy8gdHNsaW50OmRpc2FibGU6bm8tYW55IG5vLWJpZy1mdW5jdGlvbiBuby1pbXBsaWNpdC1kZXBlbmRlbmNpZXNcbmltcG9ydCB7IG5vcm1hbGl6ZSwgdmlydHVhbEZzIH0gZnJvbSAnQGFuZ3VsYXItZGV2a2l0L2NvcmUnO1xuaW1wb3J0IHsgSG9zdFNpbmssIEhvc3RUcmVlLCBTY2hlbWF0aWNFbmdpbmUgfSBmcm9tICdAYW5ndWxhci1kZXZraXQvc2NoZW1hdGljcyc7XG5pbXBvcnQgeyBGaWxlU3lzdGVtRW5naW5lSG9zdCB9IGZyb20gJ0Bhbmd1bGFyLWRldmtpdC9zY2hlbWF0aWNzL3Rvb2xzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBvZiBhcyBvYnNlcnZhYmxlT2YgfSBmcm9tICdyeGpzJztcblxuXG5kZXNjcmliZSgnRmlsZVN5c3RlbUVuZ2luZUhvc3QnLCAoKSA9PiB7XG4gIGNvbnN0IGRldmtpdFJvb3QgPSAoZ2xvYmFsIGFzIGFueSkuX0RldktpdFJvb3Q7XG4gIGNvbnN0IHJvb3QgPSBwYXRoLmpvaW4oXG4gICAgZGV2a2l0Um9vdCxcbiAgICAndGVzdHMvYW5ndWxhcl9kZXZraXQvc2NoZW1hdGljcy90b29scy9maWxlLXN5c3RlbS1lbmdpbmUtaG9zdCcsXG4gICk7XG5cbiAgaXQoJ3dvcmtzJywgKCkgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcblxuICAgIGNvbnN0IHRlc3RDb2xsZWN0aW9uID0gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ3dvcmtzJyk7XG4gICAgY29uc3Qgc2NoZW1hdGljMSA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ3NjaGVtYXRpYzEnLCB0ZXN0Q29sbGVjdGlvbik7XG5cbiAgICBleHBlY3Qoc2NoZW1hdGljMS5kZXNjcmlwdGlvbi5uYW1lKS50b0JlKCdzY2hlbWF0aWMxJyk7XG4gIH0pO1xuXG4gIGl0KCd1bmRlcnN0YW5kcyBhbGlhc2VzJywgKCkgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcblxuICAgIGNvbnN0IHRlc3RDb2xsZWN0aW9uID0gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2FsaWFzZXMnKTtcbiAgICBjb25zdCBzY2hlbWF0aWMxID0gZW5naW5lLmNyZWF0ZVNjaGVtYXRpYygnYWxpYXMxJywgdGVzdENvbGxlY3Rpb24pO1xuXG4gICAgZXhwZWN0KHNjaGVtYXRpYzEpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMxLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzEnKTtcbiAgfSk7XG5cbiAgaXQoJ3VuZGVyc3RhbmRzIG11bHRpcGxlIGFsaWFzZXMgZm9yIGEgc2luZ2xlIHNjaGVtYXRpYycsICgpID0+IHtcbiAgICBjb25zdCBlbmdpbmVIb3N0ID0gbmV3IEZpbGVTeXN0ZW1FbmdpbmVIb3N0KHJvb3QpO1xuICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBTY2hlbWF0aWNFbmdpbmUoZW5naW5lSG9zdCk7XG5cbiAgICBjb25zdCB0ZXN0Q29sbGVjdGlvbiA9IGVuZ2luZS5jcmVhdGVDb2xsZWN0aW9uKCdhbGlhc2VzLW1hbnknKTtcblxuICAgIGNvbnN0IHNjaGVtYXRpYzEgPSBlbmdpbmUuY3JlYXRlU2NoZW1hdGljKCdhbGlhczEnLCB0ZXN0Q29sbGVjdGlvbik7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzEpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMxLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzEnKTtcblxuICAgIGNvbnN0IHNjaGVtYXRpYzIgPSBlbmdpbmUuY3JlYXRlU2NoZW1hdGljKCdhbGlhczInLCB0ZXN0Q29sbGVjdGlvbik7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzIpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMyLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzEnKTtcblxuICAgIGNvbnN0IHNjaGVtYXRpYzMgPSBlbmdpbmUuY3JlYXRlU2NoZW1hdGljKCdhbGlhczMnLCB0ZXN0Q29sbGVjdGlvbik7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzMpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMzLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzEnKTtcbiAgfSk7XG5cblxuICBpdCgnYWxsb3dzIGR1cGUgYWxpYXNlcyBmb3IgYSBzaW5nbGUgc2NoZW1hdGljJywgKCkgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcblxuICAgIGNvbnN0IHRlc3RDb2xsZWN0aW9uID0gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2FsaWFzZXMtZHVwZScpO1xuXG4gICAgY29uc3Qgc2NoZW1hdGljMSA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ2FsaWFzMScsIHRlc3RDb2xsZWN0aW9uKTtcbiAgICBleHBlY3Qoc2NoZW1hdGljMSkubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzEuZGVzY3JpcHRpb24ubmFtZSkudG9CZSgnc2NoZW1hdGljMScpO1xuXG4gICAgY29uc3Qgc2NoZW1hdGljMiA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ2FsaWFzMicsIHRlc3RDb2xsZWN0aW9uKTtcbiAgICBleHBlY3Qoc2NoZW1hdGljMikubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzIuZGVzY3JpcHRpb24ubmFtZSkudG9CZSgnc2NoZW1hdGljMScpO1xuXG4gICAgY29uc3Qgc2NoZW1hdGljMyA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ2FsaWFzMycsIHRlc3RDb2xsZWN0aW9uKTtcbiAgICBleHBlY3Qoc2NoZW1hdGljMykubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzMuZGVzY3JpcHRpb24ubmFtZSkudG9CZSgnc2NoZW1hdGljMScpO1xuICB9KTtcblxuICBpdCgnbGlzdHMgc2NoZW1hdGljcyBidXQgbm90IGFsaWFzZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgZW5naW5lSG9zdCA9IG5ldyBGaWxlU3lzdGVtRW5naW5lSG9zdChyb290KTtcbiAgICBjb25zdCBlbmdpbmUgPSBuZXcgU2NoZW1hdGljRW5naW5lKGVuZ2luZUhvc3QpO1xuXG4gICAgY29uc3QgdGVzdENvbGxlY3Rpb24gPSBlbmdpbmUuY3JlYXRlQ29sbGVjdGlvbignYWxpYXNlcycpO1xuICAgIGNvbnN0IG5hbWVzID0gdGVzdENvbGxlY3Rpb24ubGlzdFNjaGVtYXRpY05hbWVzKCk7XG5cbiAgICBleHBlY3QobmFtZXMpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChuYW1lc1swXSkudG9CZSgnc2NoZW1hdGljMScpO1xuICAgIGV4cGVjdChuYW1lc1sxXSkudG9CZSgnc2NoZW1hdGljMicpO1xuICB9KTtcblxuICBpdCgnZXh0ZW5kcyBhIGNvbGxlY3Rpb24gd2l0aCBzdHJpbmcnLCAoKSA9PiB7XG4gICAgY29uc3QgZW5naW5lSG9zdCA9IG5ldyBGaWxlU3lzdGVtRW5naW5lSG9zdChyb290KTtcbiAgICBjb25zdCBlbmdpbmUgPSBuZXcgU2NoZW1hdGljRW5naW5lKGVuZ2luZUhvc3QpO1xuXG4gICAgY29uc3QgdGVzdENvbGxlY3Rpb24gPSBlbmdpbmUuY3JlYXRlQ29sbGVjdGlvbignZXh0ZW5kcy1iYXNpYy1zdHJpbmcnKTtcblxuICAgIGV4cGVjdCh0ZXN0Q29sbGVjdGlvbi5iYXNlRGVzY3JpcHRpb25zKS5ub3QudG9CZVVuZGVmaW5lZCgpO1xuICAgIGV4cGVjdCh0ZXN0Q29sbGVjdGlvbi5iYXNlRGVzY3JpcHRpb25zXG4gICAgICAgICAgICYmIHRlc3RDb2xsZWN0aW9uLmJhc2VEZXNjcmlwdGlvbnMubGVuZ3RoKS50b0JlKDEpO1xuXG4gICAgY29uc3Qgc2NoZW1hdGljMSA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ3NjaGVtYXRpYzEnLCB0ZXN0Q29sbGVjdGlvbik7XG5cbiAgICBleHBlY3Qoc2NoZW1hdGljMSkubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzEuZGVzY3JpcHRpb24ubmFtZSkudG9CZSgnc2NoZW1hdGljMScpO1xuXG4gICAgY29uc3Qgc2NoZW1hdGljMiA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ3NjaGVtYXRpYzInLCB0ZXN0Q29sbGVjdGlvbik7XG5cbiAgICBleHBlY3Qoc2NoZW1hdGljMikubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzIuZGVzY3JpcHRpb24ubmFtZSkudG9CZSgnc2NoZW1hdGljMicpO1xuXG4gICAgY29uc3QgbmFtZXMgPSB0ZXN0Q29sbGVjdGlvbi5saXN0U2NoZW1hdGljTmFtZXMoKTtcblxuICAgIGV4cGVjdChuYW1lcy5sZW5ndGgpLnRvQmUoMik7XG4gIH0pO1xuXG4gIGl0KCdleHRlbmRzIGEgY29sbGVjdGlvbiB3aXRoIGFycmF5JywgKCkgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcblxuICAgIGNvbnN0IHRlc3RDb2xsZWN0aW9uID0gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2V4dGVuZHMtYmFzaWMnKTtcblxuICAgIGV4cGVjdCh0ZXN0Q29sbGVjdGlvbi5iYXNlRGVzY3JpcHRpb25zKS5ub3QudG9CZVVuZGVmaW5lZCgpO1xuICAgIGV4cGVjdCh0ZXN0Q29sbGVjdGlvbi5iYXNlRGVzY3JpcHRpb25zXG4gICAgICAgICAgICYmIHRlc3RDb2xsZWN0aW9uLmJhc2VEZXNjcmlwdGlvbnMubGVuZ3RoKS50b0JlKDEpO1xuXG4gICAgY29uc3Qgc2NoZW1hdGljMSA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ3NjaGVtYXRpYzEnLCB0ZXN0Q29sbGVjdGlvbik7XG5cbiAgICBleHBlY3Qoc2NoZW1hdGljMSkubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzEuZGVzY3JpcHRpb24ubmFtZSkudG9CZSgnc2NoZW1hdGljMScpO1xuXG4gICAgY29uc3Qgc2NoZW1hdGljMiA9IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ3NjaGVtYXRpYzInLCB0ZXN0Q29sbGVjdGlvbik7XG5cbiAgICBleHBlY3Qoc2NoZW1hdGljMikubm90LnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzIuZGVzY3JpcHRpb24ubmFtZSkudG9CZSgnc2NoZW1hdGljMicpO1xuXG4gICAgY29uc3QgbmFtZXMgPSB0ZXN0Q29sbGVjdGlvbi5saXN0U2NoZW1hdGljTmFtZXMoKTtcblxuICAgIGV4cGVjdChuYW1lcy5sZW5ndGgpLnRvQmUoMik7XG4gIH0pO1xuXG4gIGl0KCdleHRlbmRzIGEgY29sbGVjdGlvbiB3aXRoIGZ1bGwgZGVwdGgnLCAoKSA9PiB7XG4gICAgY29uc3QgZW5naW5lSG9zdCA9IG5ldyBGaWxlU3lzdGVtRW5naW5lSG9zdChyb290KTtcbiAgICBjb25zdCBlbmdpbmUgPSBuZXcgU2NoZW1hdGljRW5naW5lKGVuZ2luZUhvc3QpO1xuXG4gICAgY29uc3QgdGVzdENvbGxlY3Rpb24gPSBlbmdpbmUuY3JlYXRlQ29sbGVjdGlvbignZXh0ZW5kcy1kZWVwJyk7XG5cbiAgICBleHBlY3QodGVzdENvbGxlY3Rpb24uYmFzZURlc2NyaXB0aW9ucykubm90LnRvQmVVbmRlZmluZWQoKTtcbiAgICBleHBlY3QodGVzdENvbGxlY3Rpb24uYmFzZURlc2NyaXB0aW9uc1xuICAgICAgICAgICAmJiB0ZXN0Q29sbGVjdGlvbi5iYXNlRGVzY3JpcHRpb25zLmxlbmd0aCkudG9CZSgyKTtcblxuICAgIGNvbnN0IHNjaGVtYXRpYzEgPSBlbmdpbmUuY3JlYXRlU2NoZW1hdGljKCdzY2hlbWF0aWMxJywgdGVzdENvbGxlY3Rpb24pO1xuXG4gICAgZXhwZWN0KHNjaGVtYXRpYzEpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMxLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzEnKTtcblxuICAgIGNvbnN0IHNjaGVtYXRpYzIgPSBlbmdpbmUuY3JlYXRlU2NoZW1hdGljKCdzY2hlbWF0aWMyJywgdGVzdENvbGxlY3Rpb24pO1xuXG4gICAgZXhwZWN0KHNjaGVtYXRpYzIpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMyLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzInKTtcblxuICAgIGNvbnN0IG5hbWVzID0gdGVzdENvbGxlY3Rpb24ubGlzdFNjaGVtYXRpY05hbWVzKCk7XG5cbiAgICBleHBlY3QobmFtZXMubGVuZ3RoKS50b0JlKDIpO1xuICB9KTtcblxuICBpdCgncmVwbGFjZXMgYmFzZSBzY2hlbWF0aWNzIHdoZW4gZXh0ZW5kaW5nJywgKCkgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcblxuICAgIGNvbnN0IHRlc3RDb2xsZWN0aW9uID0gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2V4dGVuZHMtcmVwbGFjZScpO1xuXG4gICAgZXhwZWN0KHRlc3RDb2xsZWN0aW9uLmJhc2VEZXNjcmlwdGlvbnMpLm5vdC50b0JlVW5kZWZpbmVkKCk7XG4gICAgZXhwZWN0KHRlc3RDb2xsZWN0aW9uLmJhc2VEZXNjcmlwdGlvbnNcbiAgICAgICAgICAgJiYgdGVzdENvbGxlY3Rpb24uYmFzZURlc2NyaXB0aW9ucy5sZW5ndGgpLnRvQmUoMSk7XG5cbiAgICBjb25zdCBzY2hlbWF0aWMxID0gZW5naW5lLmNyZWF0ZVNjaGVtYXRpYygnc2NoZW1hdGljMScsIHRlc3RDb2xsZWN0aW9uKTtcblxuICAgIGV4cGVjdChzY2hlbWF0aWMxKS5ub3QudG9CZU51bGwoKTtcbiAgICBleHBlY3Qoc2NoZW1hdGljMS5kZXNjcmlwdGlvbi5uYW1lKS50b0JlKCdzY2hlbWF0aWMxJyk7XG4gICAgZXhwZWN0KHNjaGVtYXRpYzEuZGVzY3JpcHRpb24uZGVzY3JpcHRpb24pLnRvQmUoJ3JlcGxhY2VkJyk7XG5cbiAgICBjb25zdCBuYW1lcyA9IHRlc3RDb2xsZWN0aW9uLmxpc3RTY2hlbWF0aWNOYW1lcygpO1xuXG4gICAgZXhwZWN0KG5hbWVzKS5ub3QudG9CZU51bGwoKTtcbiAgICBleHBlY3QobmFtZXMubGVuZ3RoKS50b0JlKDEpO1xuICB9KTtcblxuICBpdCgnZXh0ZW5kcyBtdWx0aXBsZSBjb2xsZWN0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBlbmdpbmVIb3N0ID0gbmV3IEZpbGVTeXN0ZW1FbmdpbmVIb3N0KHJvb3QpO1xuICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBTY2hlbWF0aWNFbmdpbmUoZW5naW5lSG9zdCk7XG5cbiAgICBjb25zdCB0ZXN0Q29sbGVjdGlvbiA9IGVuZ2luZS5jcmVhdGVDb2xsZWN0aW9uKCdleHRlbmRzLW11bHRpcGxlJyk7XG5cbiAgICBleHBlY3QodGVzdENvbGxlY3Rpb24uYmFzZURlc2NyaXB0aW9ucykubm90LnRvQmVVbmRlZmluZWQoKTtcbiAgICBleHBlY3QodGVzdENvbGxlY3Rpb24uYmFzZURlc2NyaXB0aW9uc1xuICAgICAgICAgICAmJiB0ZXN0Q29sbGVjdGlvbi5iYXNlRGVzY3JpcHRpb25zLmxlbmd0aCkudG9CZSg0KTtcblxuICAgIGNvbnN0IHNjaGVtYXRpYzEgPSBlbmdpbmUuY3JlYXRlU2NoZW1hdGljKCdzY2hlbWF0aWMxJywgdGVzdENvbGxlY3Rpb24pO1xuXG4gICAgZXhwZWN0KHNjaGVtYXRpYzEpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMxLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzEnKTtcbiAgICBleHBlY3Qoc2NoZW1hdGljMS5kZXNjcmlwdGlvbi5kZXNjcmlwdGlvbikudG9CZSgncmVwbGFjZWQnKTtcblxuICAgIGNvbnN0IHNjaGVtYXRpYzIgPSBlbmdpbmUuY3JlYXRlU2NoZW1hdGljKCdzY2hlbWF0aWMyJywgdGVzdENvbGxlY3Rpb24pO1xuXG4gICAgZXhwZWN0KHNjaGVtYXRpYzIpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzY2hlbWF0aWMyLmRlc2NyaXB0aW9uLm5hbWUpLnRvQmUoJ3NjaGVtYXRpYzInKTtcblxuICAgIGNvbnN0IG5hbWVzID0gdGVzdENvbGxlY3Rpb24ubGlzdFNjaGVtYXRpY05hbWVzKCk7XG5cbiAgICBleHBlY3QobmFtZXMpLm5vdC50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChuYW1lcy5sZW5ndGgpLnRvQmUoMik7XG4gIH0pO1xuXG4gIGl0KCdlcnJvcnMgb24gc2ltcGxlIGNpcmN1bGFyIGNvbGxlY3Rpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcblxuICAgIGV4cGVjdCgoKSA9PiBlbmdpbmUuY3JlYXRlQ29sbGVjdGlvbignZXh0ZW5kcy1jaXJjdWxhcicpKS50b1Rocm93KCk7XG4gIH0pO1xuXG4gIGl0KCdlcnJvcnMgb24gY29tcGxleCBjaXJjdWxhciBjb2xsZWN0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBlbmdpbmVIb3N0ID0gbmV3IEZpbGVTeXN0ZW1FbmdpbmVIb3N0KHJvb3QpO1xuICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBTY2hlbWF0aWNFbmdpbmUoZW5naW5lSG9zdCk7XG5cbiAgICBleHBlY3QoKCkgPT4gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2V4dGVuZHMtY2lyY3VsYXItbXVsdGlwbGUnKSkudG9UaHJvdygpO1xuICB9KTtcblxuICBpdCgnZXJyb3JzIG9uIGRlZXAgY2lyY3VsYXIgY29sbGVjdGlvbnMnLCAoKSA9PiB7XG4gICAgY29uc3QgZW5naW5lSG9zdCA9IG5ldyBGaWxlU3lzdGVtRW5naW5lSG9zdChyb290KTtcbiAgICBjb25zdCBlbmdpbmUgPSBuZXcgU2NoZW1hdGljRW5naW5lKGVuZ2luZUhvc3QpO1xuXG4gICAgZXhwZWN0KCgpID0+IGVuZ2luZS5jcmVhdGVDb2xsZWN0aW9uKCdleHRlbmRzLWNpcmN1bGFyLWRlZXAnKSkudG9UaHJvdygpO1xuICB9KTtcblxuICBpdCgnZXJyb3JzIG9uIGludmFsaWQgYWxpYXNlcycsICgpID0+IHtcbiAgICBjb25zdCBlbmdpbmVIb3N0ID0gbmV3IEZpbGVTeXN0ZW1FbmdpbmVIb3N0KHJvb3QpO1xuICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBTY2hlbWF0aWNFbmdpbmUoZW5naW5lSG9zdCk7XG5cbiAgICBleHBlY3QoKCkgPT4gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2ludmFsaWQtYWxpYXNlcycpKS50b1Rocm93KCk7XG4gIH0pO1xuXG4gIGl0KCdlcnJvcnMgb24gaW52YWxpZCBhbGlhc2VzICgyKScsICgpID0+IHtcbiAgICBjb25zdCBlbmdpbmVIb3N0ID0gbmV3IEZpbGVTeXN0ZW1FbmdpbmVIb3N0KHJvb3QpO1xuICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBTY2hlbWF0aWNFbmdpbmUoZW5naW5lSG9zdCk7XG5cbiAgICBleHBlY3QoKCkgPT4gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2ludmFsaWQtYWxpYXNlcy0yJykpLnRvVGhyb3coKTtcbiAgfSk7XG5cbiAgaXQoJ2RvZXMgbm90IGxpc3QgaGlkZGVuIHNjaGVtYXRpY3MnLCAoKSA9PiB7XG4gICAgY29uc3QgZW5naW5lSG9zdCA9IG5ldyBGaWxlU3lzdGVtRW5naW5lSG9zdChyb290KTtcbiAgICBjb25zdCBlbmdpbmUgPSBuZXcgU2NoZW1hdGljRW5naW5lKGVuZ2luZUhvc3QpO1xuICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBlbmdpbmUuY3JlYXRlQ29sbGVjdGlvbignaGlkZGVuLXNjaGVtYXRpY3MnKTtcblxuICAgIGV4cGVjdChjb2xsZWN0aW9uLmxpc3RTY2hlbWF0aWNOYW1lcygpKS50b0VxdWFsKFtcbiAgICAgICdzY2hlbWF0aWMtMScsXG4gICAgICAnc2NoZW1hdGljLTInLFxuICAgIF0pO1xuICB9KTtcblxuICBpdCgnZG9lcyBub3QgbGlzdCBwcml2YXRlIHNjaGVtYXRpY3MnLCAoKSA9PiB7XG4gICAgY29uc3QgZW5naW5lSG9zdCA9IG5ldyBGaWxlU3lzdGVtRW5naW5lSG9zdChyb290KTtcbiAgICBjb25zdCBlbmdpbmUgPSBuZXcgU2NoZW1hdGljRW5naW5lKGVuZ2luZUhvc3QpO1xuICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBlbmdpbmUuY3JlYXRlQ29sbGVjdGlvbigncHJpdmF0ZS1zY2hlbWF0aWNzJyk7XG5cbiAgICBleHBlY3QoY29sbGVjdGlvbi5saXN0U2NoZW1hdGljTmFtZXMoKSkudG9FcXVhbChbXG4gICAgICAnc2NoZW1hdGljLTEnLFxuICAgICAgJ3NjaGVtYXRpYy0yJyxcbiAgICBdKTtcbiAgfSk7XG5cbiAgaXQoJ2Nhbm5vdCBpbnN0YW5jaWF0ZSBhIHByaXZhdGUgc2NoZW1hdGljJywgKCkgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcblxuICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBlbmdpbmUuY3JlYXRlQ29sbGVjdGlvbigncHJpdmF0ZS1zY2hlbWF0aWNzJyk7XG4gICAgZXhwZWN0KCgpID0+IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ3NjaGVtYXRpYy0xJywgY29sbGVjdGlvbikpLm5vdC50b1Rocm93KCk7XG4gICAgZXhwZWN0KCgpID0+IGVuZ2luZS5jcmVhdGVTY2hlbWF0aWMoJ3ByaXZhdGUtc2NoZW1hdGljJywgY29sbGVjdGlvbikpLnRvVGhyb3coKTtcbiAgICBleHBlY3QoKCkgPT4gY29sbGVjdGlvbi5jcmVhdGVTY2hlbWF0aWMoJ3ByaXZhdGUtc2NoZW1hdGljJykpLnRvVGhyb3coKTtcbiAgfSk7XG5cbiAgaXQoJ2FsbG93cyBleHRyYSBwcm9wZXJ0aWVzIG9uIHNjaGVtYScsIGRvbmUgPT4ge1xuICAgIGNvbnN0IGVuZ2luZUhvc3QgPSBuZXcgRmlsZVN5c3RlbUVuZ2luZUhvc3Qocm9vdCk7XG4gICAgY29uc3QgZW5naW5lID0gbmV3IFNjaGVtYXRpY0VuZ2luZShlbmdpbmVIb3N0KTtcbiAgICBjb25zdCBob3N0ID0gbmV3IHZpcnR1YWxGcy50ZXN0LlRlc3RIb3N0KCk7XG5cbiAgICBjb25zdCBjb2xsZWN0aW9uID0gZW5naW5lLmNyZWF0ZUNvbGxlY3Rpb24oJ2V4dHJhLXByb3BlcnRpZXMnKTtcbiAgICBjb25zdCBzY2hlbWF0aWMgPSBjb2xsZWN0aW9uLmNyZWF0ZVNjaGVtYXRpYygnc2NoZW1hdGljMScpO1xuXG4gICAgc2NoZW1hdGljLmNhbGwoe30sIG9ic2VydmFibGVPZihuZXcgSG9zdFRyZWUoaG9zdCkpKS50b1Byb21pc2UoKVxuICAgICAgLnRoZW4odHJlZSA9PiB7XG4gICAgICAgIHJldHVybiBuZXcgSG9zdFNpbmsoaG9zdCkuY29tbWl0KHRyZWUpLnRvUHJvbWlzZSgpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGhvc3QuZmlsZXMgYXMgc3RyaW5nW10pLnRvRXF1YWwoWycvZXh0cmEtc2NoZW1hdGljJ10pO1xuICAgICAgICBleHBlY3QoaG9zdC5zeW5jLnJlYWQobm9ybWFsaXplKCcvZXh0cmEtc2NoZW1hdGljJykpLnRvU3RyaW5nKCkpXG4gICAgICAgICAgLnRvRXF1YWwoJ2V4dHJhLWNvbGxlY3Rpb24nKTtcbiAgICAgIH0pXG4gICAgICAudGhlbihkb25lLCBkb25lLmZhaWwpO1xuICB9KTtcbn0pO1xuIl19